You have selected an image input
shared feature network
Model: "feature_net"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         [(None, 48, 48, 3)]       0
_________________________________________________________________
conv2d (Conv2D)              (None, 24, 24, 16)        1216
_________________________________________________________________
batch_normalization (BatchNo (None, 24, 24, 16)        64
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 12, 12, 32)        12832
_________________________________________________________________
batch_normalization_1 (Batch (None, 12, 12, 32)        128
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 6, 6, 32)          25632
_________________________________________________________________
batch_normalization_2 (Batch (None, 6, 6, 32)          128
_________________________________________________________________
flatten (Flatten)            (None, 1152)              0
_________________________________________________________________
dense (Dense)                (None, 128)               147584
_________________________________________________________________
dense_1 (Dense)              (None, 128)               16512
_________________________________________________________________
dense_2 (Dense)              (None, 64)                8256
=================================================================
Total params: 212,352
Trainable params: 212,192
Non-trainable params: 160
_________________________________________________________________
Model: "actor"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_2 (InputLayer)         [(None, 48, 48, 3)]       0
_________________________________________________________________
feature_net (Functional)     (None, 64)                212352
_________________________________________________________________
dense_3 (Dense)              (None, 256)               16640
_________________________________________________________________
dense_4 (Dense)              (None, 128)               32896
_________________________________________________________________
dense_5 (Dense)              (None, 64)                8256
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 195
_________________________________________________________________
tf.math.multiply (TFOpLambda (None, 3)                 0
=================================================================
Total params: 270,339
Trainable params: 270,179
Non-trainable params: 160
_________________________________________________________________
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_3 (InputLayer)            [(None, 48, 48, 3)]  0
__________________________________________________________________________________________________
feature_net (Functional)        (None, 64)           212352      input_3[0][0]
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 32)           2080        feature_net[1][0]
__________________________________________________________________________________________________
input_4 (InputLayer)            [(None, 3)]          0
__________________________________________________________________________________________________
dense_8 (Dense)                 (None, 32)           1056        dense_7[0][0]
__________________________________________________________________________________________________
dense_9 (Dense)                 (None, 32)           128         input_4[0][0]
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 64)           0           dense_8[0][0]
                                                                 dense_9[0][0]
__________________________________________________________________________________________________
dense_10 (Dense)                (None, 128)          8320        concatenate[0][0]
__________________________________________________________________________________________________
dense_11 (Dense)                (None, 64)           8256        dense_10[0][0]
__________________________________________________________________________________________________
dense_12 (Dense)                (None, 1)            65          dense_11[0][0]
==================================================================================================
Total params: 232,257
Trainable params: 232,097
Non-trainable params: 160
__________________________________________________________________________________________________
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_5 (InputLayer)            [(None, 48, 48, 3)]  0
__________________________________________________________________________________________________
feature_net (Functional)        (None, 64)           212352      input_5[0][0]
__________________________________________________________________________________________________
dense_13 (Dense)                (None, 32)           2080        feature_net[2][0]
__________________________________________________________________________________________________
input_6 (InputLayer)            [(None, 3)]          0
__________________________________________________________________________________________________
dense_14 (Dense)                (None, 32)           1056        dense_13[0][0]
__________________________________________________________________________________________________
dense_15 (Dense)                (None, 32)           128         input_6[0][0]
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 64)           0           dense_14[0][0]
                                                                 dense_15[0][0]
__________________________________________________________________________________________________
dense_16 (Dense)                (None, 128)          8320        concatenate_1[0][0]
__________________________________________________________________________________________________
dense_17 (Dense)                (None, 64)           8256        dense_16[0][0]
__________________________________________________________________________________________________
dense_18 (Dense)                (None, 1)            65          dense_17[0][0]
==================================================================================================
Total params: 232,257
Trainable params: 232,097
Non-trainable params: 160
__________________________________________________________________________________________________
Model: "model_2"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_7 (InputLayer)            [(None, 48, 48, 3)]  0
__________________________________________________________________________________________________
feature_net (Functional)        (None, 64)           212352      input_7[0][0]
__________________________________________________________________________________________________
dense_19 (Dense)                (None, 32)           2080        feature_net[3][0]
__________________________________________________________________________________________________
input_8 (InputLayer)            [(None, 3)]          0
__________________________________________________________________________________________________
dense_20 (Dense)                (None, 32)           1056        dense_19[0][0]
__________________________________________________________________________________________________
dense_21 (Dense)                (None, 32)           128         input_8[0][0]
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 64)           0           dense_20[0][0]
                                                                 dense_21[0][0]
__________________________________________________________________________________________________
dense_22 (Dense)                (None, 128)          8320        concatenate_2[0][0]
__________________________________________________________________________________________________
dense_23 (Dense)                (None, 64)           8256        dense_22[0][0]
__________________________________________________________________________________________________
dense_24 (Dense)                (None, 1)            65          dense_23[0][0]
==================================================================================================
Total params: 232,257
Trainable params: 232,097
Non-trainable params: 160
__________________________________________________________________________________________________
Model: "model_3"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_9 (InputLayer)            [(None, 48, 48, 3)]  0
__________________________________________________________________________________________________
feature_net (Functional)        (None, 64)           212352      input_9[0][0]
__________________________________________________________________________________________________
dense_25 (Dense)                (None, 32)           2080        feature_net[4][0]
__________________________________________________________________________________________________
input_10 (InputLayer)           [(None, 3)]          0
__________________________________________________________________________________________________
dense_26 (Dense)                (None, 32)           1056        dense_25[0][0]
__________________________________________________________________________________________________
dense_27 (Dense)                (None, 32)           128         input_10[0][0]
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 64)           0           dense_26[0][0]
                                                                 dense_27[0][0]
__________________________________________________________________________________________________
dense_28 (Dense)                (None, 128)          8320        concatenate_3[0][0]
__________________________________________________________________________________________________
dense_29 (Dense)                (None, 64)           8256        dense_28[0][0]
__________________________________________________________________________________________________
dense_30 (Dense)                (None, 1)            65          dense_29[0][0]
==================================================================================================
Total params: 232,257
Trainable params: 232,097
Non-trainable params: 160
__________________________________________________________________________________________________
2021-07-26 19:05:45.758626: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-26 19:05:45.759130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:01:00.0 name: GeForce RTX 2060 computeCapability: 7.5
coreClock: 1.2GHz coreCount: 30 deviceMemorySize: 5.79GiB deviceMemoryBandwidth: 312.97GiB/s
2021-07-26 19:05:45.759176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-07-26 19:05:45.759268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-07-26 19:05:45.759304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-07-26 19:05:45.759357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-07-26 19:05:45.759375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-07-26 19:05:45.759393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-07-26 19:05:45.759411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-07-26 19:05:45.759430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-07-26 19:05:45.759502: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-26 19:05:45.759927: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-26 19:05:45.760285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-07-26 19:05:45.760332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-26 19:05:45.760341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-07-26 19:05:45.760361: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-07-26 19:05:45.760453: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-26 19:05:45.760855: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-07-26 19:05:45.761231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 5044 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2060, pci bus id: 0000:01:00.0, compute capability: 7.5)
2021-07-26 19:05:45.761270: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-07-26 19:05:47.331760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-07-26 19:05:48.104546: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2021-07-26 19:05:48.143433: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output:
Relying on driver to perform ptx compilation.
Modify $PATH to customize ptxas location.
This message will be only logged once.
2021-07-26 19:05:48.423423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
/home/swagat/GIT/RL-Projects-SK/src/kukacam/SAC/sac2.py:601: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  target_wts1 = np.array(self.target_critic1.model.get_weights())
/home/swagat/GIT/RL-Projects-SK/src/kukacam/SAC/sac2.py:602: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  wts1 = np.array(self.critic1.model.get_weights())
/home/swagat/GIT/RL-Projects-SK/src/kukacam/SAC/sac2.py:603: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  target_wts2 = np.array(self.target_critic2.model.get_weights())
/home/swagat/GIT/RL-Projects-SK/src/kukacam/SAC/sac2.py:604: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  wts2 = np.array(self.critic2.model.get_weights())
Season: 0, Update best score: -inf-->0.32608695652173914, Model saved!
Traceback (most recent call last):
  File "/home/swagat/GIT/RL-Projects-SK/src/kukacam/main2.py", line 345, in <module>
  File "/home/swagat/GIT/RL-Projects-SK/src/kukacam/main2.py", line 225, in run
  File "/home/swagat/GIT/RL-Projects-SK/src/kukacam/SAC/sac2.py", line 632, in replay
    self.alpha)
  File "/home/swagat/GIT/RL-Projects-SK/src/kukacam/SAC/sac2.py", line 180, in train
    q1_target = target_critic1(next_states, a_next)
  File "/home/swagat/GIT/RL-Projects-SK/src/kukacam/SAC/sac2.py", line 167, in __call__
    q_value = tf.squeeze(self.model([state, action]))
  File "/home/swagat/anaconda3/envs/tf2py37/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 1012, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "/home/swagat/anaconda3/envs/tf2py37/lib/python3.7/site-packages/tensorflow/python/keras/engine/functional.py", line 425, in call
    inputs, training=training, mask=mask)
  File "/home/swagat/anaconda3/envs/tf2py37/lib/python3.7/site-packages/tensorflow/python/keras/engine/functional.py", line 560, in _run_internal_graph
    outputs = node.layer(*args, **kwargs)
  File "/home/swagat/anaconda3/envs/tf2py37/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 1006, in __call__
    with ops.name_scope_v2(name_scope):
  File "/home/swagat/anaconda3/envs/tf2py37/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 6636, in __enter__
    elif name[-1] == "/":
KeyboardInterrupt